sequenceDiagram
    participant Client as HTTP Client (Invoke-WebRequest/curl)
    participant App as gateway_app (REST server)
    participant Core as GatewayCore
    participant Q as TelemetryQueue
    participant Dev as Device

    alt Start via GUI or Script
        GUI->>App: POST /start
        Script->>App: POST /start
    end
    App->>Core: start()
    Core->>Dev: start()
    Core->>Q: push samples

    loop monitoring
    loop Every 1s (GUI polling)
        GUI->>App: GET /status
        App->>Core: device_state(), latest_sample()
        Core-->>App: state + sample
        App-->>Client: JSON { state, latest_sample }
    end

    Script->>App: POST /stop
    App->>Core: stop()
    Core->>Dev: stop()
